#include "mbed.h"                           //inkluder et stort biblotek med mange funskjoner
BusOut motor(PA_9,PC_7,PB_6,PA_7);          ///setter opp en outputBus som Motor med gitte utganger

int main()
{
double NOW=0;                               //deffinerer en double NOW som 0
double NOW2=0;                              //deffinerer en double NOW2 som 0
int i=0;                                    //deffinerer en int i til 0

char buffer[80];                            //deffienerer en tabell som buffer med størelse 80
    while (1)
    { 
        scanf("%[^\r\n]s",buffer);  // Leser seriell informasjon og lagrer i buffer
        getchar();                  //leser en newline
        int grader = atoi(buffer);  //deffinerer int grader som int verdien til stringen buffer
    
            
        if (grader<=360)                //hvis grader er mindre eller lik 360
        { 
       
            if (NOW<(grader*1.42))      //hvis NOW er mindre en grader ganger 1.42, gå inn her
            { 
                for(i=((int)NOW);i<=(grader*1.42);i++)      //for løkke som går  differansen mellom NOW og grader*1.42
                { 
               
                NOW= i;                 //endrer Now verdi til i verdi
                NOW2= (NOW/1.42);       //endrer NOW2 til NOW/1.42
                printf("%d",(int)NOW2); //skriver til seriell port intverdien til NOW2
                printf("\r\n");         //skiver til seriell port en newline
                
               
                motor=0b1001;
                wait_ms(10);
                motor=0b1100;
                wait_ms(10);                //styrer motor til høyre
                motor=0b0110;
                wait_ms(10);
                motor=0b0011;
                wait_ms(10);
                
                
                 }
                
                
               
            }
            if (NOW>(grader*1.42))      //Hvis NoW er større enn grader ganger 1.42, gå inn her
            {
                for(i=((int)NOW);i>=(grader*1.42);i--)      //for løkke som går differansen mellom NOW og grader*1.42
                {
                NOW=i;                      //endrer Now verdi til i verdi
                NOW2= (NOW/1.42);           //endrer NOW2 til NOW/1.42
                printf("%d",(int)NOW2);     //skriver til seriell port intverdien til NOW2
                printf("\r\n");             //skiver til seriell port en newline
                motor=0b0011;
                wait_ms(10);
                motor=0b0110;           //styrer motor til venstre
                wait_ms(10);
                motor=0b1100;
                wait_ms(10);
                motor=0b1001;
                wait_ms(10);
                
                }
               
            }
        }
        if(grader>360)      //hvis grader er større enn 360 gå inn her
        {
            
            if((grader<=616)&&(grader>=580)&&(i<513)) // hvis grader er mellom 616 og 580 og i er mindre enn 513, gå inn her
            {      
            
            
                for(int s=0;s<2;s++)                //for løkke som går 2 ganger
                {
                motor=0b1001;
                wait_ms(10);
                motor=0b1100;
                wait_ms(10);            //styrer motor til høyre
                motor=0b0110;
                wait_ms(10);
                motor=0b0011;
                wait_ms(10);
                }
            i=i+2;                  //endrer i til 2+i
            NOW=i;                  //endrer Now til i
            NOW2= (i/1.42);         //endrer NOW2 til NOW/1.42
            printf("%d",(int)NOW2); //skriver til seriell port intverdien til NOW2
            printf("\r\n");         //skiver til seriell port en newline
            
            
            
        }
       
        
            if(( grader <= 390 )&&(grader > 360)&&(NOW>=0))                        //hvis grader er mindre enn 390 og større enn 360 sammtidig som NOW er større enn 0
            {

            
          
            
                for(int s=0;s<2;s++)    //for løkke som går 2 ganger
                {
                motor=0b0011;
                wait_ms(10);
                motor=0b0110;           //styrer motor til venstre
                wait_ms(10);
                motor=0b1100;
                wait_ms(10);
                motor=0b1001;
                wait_ms(10);
                }
            
            i=i-2;              //endrer i til i-2
            NOW=i;              // //endrer Now til i
            NOW2= (i/1.42);     //endrer NOW2 til NOW/1.42
            printf("%d",(int)NOW2);     //skriver til seriell port intverdien til NOW2
            printf("\r\n");             //skiver til seriell port en newline
            
           
            
          
        }
      
    
       
      
        }   
           
       
        
            
    
        
    
        
    }
}
